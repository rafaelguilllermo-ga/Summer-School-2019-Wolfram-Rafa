(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     85959,       1960]
NotebookOptionsPosition[     81737,       1888]
NotebookOutlinePosition[     82570,       1916]
CellTagsIndexPosition[     82527,       1913]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["Rafael Guillermo Gonz\[AAcute]lez  Acu\[NTilde]a ", "Subsection",
 CellChangeTimes->{{3.7707666741802917`*^9, 
  3.770766722867231*^9}},ExpressionUUID->"0a0c05ef-d25e-483c-a9d6-\
8227b43c03fe"],

Cell[CellGroupData[{

Cell["The Cartesian oval collimator ", "Title",
 CellChangeTimes->{{3.770419696422654*^9, 3.7704197175829873`*^9}, {
  3.770420058812704*^9, 
  3.7704200624720807`*^9}},ExpressionUUID->"3c68f453-d93c-4770-a810-\
86b2cbc3059d"],

Cell["\<\
In geometry, a Cartesian oval, named after Ren\[EAcute] Descartes, is a plane \
curve, the set of points that have the same linear combination of distances \
from two fixed points.
As Descartes discovered, Cartesian ovals may be used in lens design. By \
choosing the ratio of distances from ta and tb to match the ratio of sines in \
Snell\[CloseCurlyQuote]s law, and using the surface of revolution of one of \
these ovals. The Fermat principle it predicts that the optical path of the \
axial ray is equal to the path of any non-axial ray.\
\>", "Text",
 CellChangeTimes->{
  3.7704198351764617`*^9, {3.7704198705718613`*^9, 3.770419967303774*^9}, {
   3.7705048913239784`*^9, 
   3.770504915924108*^9}},ExpressionUUID->"d824b6da-0fc2-489b-b28b-\
babdff7e86c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "ta"}], "+", 
   RowBox[{"n", " ", "tb"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"za", "-", "ta"}], ")"}], "^", "2"}], "+", 
     RowBox[{"ra", "^", "2"}]}], "]"}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"tb", "-", "za"}], ")"}], "^", "2"}], "+", 
      RowBox[{"ra", "^", "2"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7397338378256474`*^9, 3.7397338390072193`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"89fc2d61-13f5-499c-84d7-ae02fb259491"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "ta"}], "+", 
   RowBox[{"n", " ", "tb"}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"n", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["ra", "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"tb", "-", "za"}], ")"}], "2"]}]]}], "+", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["ra", "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ta"}], "+", "za"}], ")"}], "2"]}]]}]}]], "Output",
 CellChangeTimes->{3.77076674666157*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"5647ec4e-d22a-4c6e-805b-70e666f690d7"]
}, Open  ]],

Cell["\<\
Where,  ta is the first point, tb is the second point,  n is the refraction \
index, ra is the independent variable and za is the profile of the Cartesian \
oval.  If we take tb to tend to infinity we have a Cartesian oval collimator \
equation of the optical path, the optical path of the axial ray and the \
optical path of a not axial ray. So the only thing that we need to do is to \
compute the limit when tb tends to infinity in the previous equation and we \
get,\
\>", "Text",
 CellChangeTimes->{{3.770420034350131*^9, 3.770420066121709*^9}, {
  3.7704201050720453`*^9, 3.7704201863988047`*^9}, {3.770770131128113*^9, 
  3.7707701553735323`*^9}, {3.770770214714692*^9, 
  3.7707702581720667`*^9}},ExpressionUUID->"396a3057-5a76-49cb-8f73-\
008848b08113"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "ta"}], "+", 
    RowBox[{"n", " ", "tb"}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"za", "-", "ta"}], ")"}], "^", "2"}], "+", 
        RowBox[{"ra", "^", "2"}]}], "]"}], "+", 
      RowBox[{"n", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tb", "-", "za"}], ")"}], "^", "2"}], "+", 
         RowBox[{"ra", "^", "2"}]}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{"tb", "\[Rule]", "Infinity"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7292917467586656`*^9, 3.7292918130716066`*^9}, {
   3.7292932422563653`*^9, 3.729293255381613*^9}, 3.7397338954900246`*^9, {
   3.7704200172167025`*^9, 3.770420022675812*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"db1aa806-1d9c-4296-8230-b009757f0115"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "ta"}], "-", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["ra", "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"ta", "-", "za"}], ")"}], "2"]}]], "+", 
  RowBox[{"n", " ", "za"}]}]], "Output",
 CellChangeTimes->{3.729291815120795*^9, 3.729293209501354*^9, 
  3.739733897539607*^9, 3.770420073625589*^9, 3.770766747733737*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"e3d727d2-780b-4267-a921-777cabdc2220"]
}, Open  ]],

Cell["\<\
Solving for za, we get the profile of the Cartesian oval collimator, where ra \
is the independent variable on the horizontal axis\
\>", "Text",
 CellChangeTimes->{{3.770420198854948*^9, 3.770420201890371*^9}, 
   3.770420790431301*^9, {3.7705049393609686`*^9, 3.7705049505133076`*^9}, {
   3.770725650261256*^9, 
   3.770725671279708*^9}},ExpressionUUID->"23360abf-7ed9-45db-a940-\
d275fb0dd6d9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PosibleSolutions", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"0", "\[Equal]", 
      RowBox[{
       RowBox[{"-", "ta"}], "-", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["ra", "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"ta", "-", "za"}], ")"}], "2"]}]], "+", 
       RowBox[{"n", " ", "za"}]}]}], ",", "za"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7707257038924685`*^9, 3.7707257060587053`*^9}, {
  3.7707258510354776`*^9, 3.770725856265481*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"76a6dc3b-8e8a-4d2c-a86d-3b8f2dce7ff7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"za", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "ta"}], "-", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["n", "2"]}], ")"}], " ", 
          SuperscriptBox["ra", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
          SuperscriptBox["ta", "2"]}]}]]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["n", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"za", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "ta"}], "+", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["n", "2"]}], ")"}], " ", 
          SuperscriptBox["ra", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
          SuperscriptBox["ta", "2"]}]}]]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["n", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7707257073771443`*^9, 3.770725857569995*^9, 
  3.7707270845291157`*^9, 3.7707667504284925`*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"4050e38b-5c2b-424f-beac-d6d0453ce312"]
}, Open  ]],

Cell["\<\
So for lets put the refraction index as n=1.5 and the focus at ta=-20, just \
to see which of the two possible solutions, which is correct and which is \
wrong, since the previous preceding give us two equations.\
\>", "Text",
 CellChangeTimes->{{3.7707259519066367`*^9, 3.7707260297553864`*^9}, {
  3.7707270870435452`*^9, 3.770727087589052*^9}, {3.770770093367902*^9, 
  3.7707701114940786`*^9}, {3.7707702770780396`*^9, 
  3.7707702970685463`*^9}},ExpressionUUID->"6fa46ee5-f075-4a08-a0c5-\
feacafba4ffe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PosibleSolution1", "=", 
   RowBox[{
    RowBox[{"za", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PosibleSolutions", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ")"}], "/.", 
       RowBox[{"ta", "\[Rule]", 
        RowBox[{"-", "20"}]}]}], ")"}]}], "/.", 
    RowBox[{"n", "\[Rule]", "1.5"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770726048154168*^9, 3.7707260689226103`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"b97b2dc8-58c8-4114-a561-56cd11a40d4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PosibleSolution2", "=", 
   RowBox[{
    RowBox[{"za", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"PosibleSolutions", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ")"}], "/.", 
       RowBox[{"ta", "\[Rule]", 
        RowBox[{"-", "20"}]}]}], ")"}]}], "/.", 
    RowBox[{"n", "\[Rule]", "1.5"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7707260735272923`*^9, 3.770726075917902*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"497c2507-61a5-47f6-8380-af0162628751"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PosibleSolution1", ",", "PosibleSolution2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ra", ",", 
       RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7707260899194403`*^9, 3.7707261007634296`*^9}, 
   3.770726180016423*^9, {3.7707262525394144`*^9, 3.7707262826967072`*^9}, {
   3.7707263444517956`*^9, 3.7707264355441203`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c8c9f424-4879-4255-8a9a-9987c645a812"],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{{}, {}, 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.368417, 0.506779, 0.709798], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
          "]]}, Annotation[#, "Charting`Private`Tag$2359#1"]& ], 
       TagBox[{
         Directive[
          Opacity[1.], 
          RGBColor[0.880722, 0.611041, 0.142051], 
          AbsoluteThickness[1.6]], 
         LineBox[CompressedData["
1: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
7x/xX6OgadmItaRFMvq/8zv6//P7fwF1DqTW
          "]]}, Annotation[#, "Charting`Private`Tag$2359#2"]& ]}}, {}}, {
    PlotRange -> All, DisplayFunction -> Identity, 
     Ticks -> {Automatic, Automatic}, AxesOrigin -> {0, 0}, 
     FrameTicks -> {{Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
        Charting`ScaledFrameTicks[{Identity, Identity}]}}, 
     GridLines -> {None, None}, DisplayFunction -> Identity, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, PlotRangeClipping -> True, ImagePadding -> All, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, 
       "DefaultGraphicsInteraction" -> {
        "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
         "Effects" -> {
          "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
           "Droplines" -> {
            "freeformCursorMode" -> True, 
             "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
       "DefaultMeshStyle" -> AbsolutePointSize[6], "ScalingFunctions" -> None,
        "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Identity[#]& )[
            Part[#, 1]], 
           (Identity[#]& )[
            Part[#, 2]]}& )}}, 
     PlotRange -> {{-10, 10}, {-19.99999972789116, 3.9999997278911597`}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.02]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"PosibleSolution1", "PosibleSolution2"}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{
               TagBox[#, HoldForm], ",", 
               TagBox[#2, HoldForm]}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.7707263951691246`*^9, 3.770726436932407*^9}, 
   3.7707270969438343`*^9, 3.7707667569181595`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"91358c7e-be56-42c5-9789-5102894f736a"]
}, Open  ]],

Cell["\<\
From the figure we can see that the plots that is correct is the Possible \
solution 2 because where is placed the other solution is no scenes.\
\>", "Text",
 CellChangeTimes->{{3.7707263043308344`*^9, 3.7707263415236645`*^9}, {
  3.7707264583929977`*^9, 
  3.7707264921846027`*^9}},ExpressionUUID->"f97fcd83-c9d2-462b-958d-\
d0935e1c04c9"],

Cell["\<\
We get two solution where one of the solutions is valid for positive \
refraction index, to know which solution is the right we plot them.\
\>", "Text",
 CellChangeTimes->{{3.7707257176436834`*^9, 3.7707257681601696`*^9}, {
  3.7707268169162254`*^9, 
  3.7707268177500243`*^9}},ExpressionUUID->"10670887-f09d-4043-8369-\
1253eb0bef9c"],

Cell["\<\
Now it is time, to focus on the ray tracing, for that we recall the Snell\
\[CloseCurlyQuote]s law\
\>", "Text",
 CellChangeTimes->{{3.770734706738784*^9, 
  3.770734739871295*^9}},ExpressionUUID->"0ec191c2-c945-4bfd-aab1-\
c144622a8e0d"],

Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1: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
3pAnN6Xf0hUKQ4YMaWxsTOOPEowES29HnreoQR6NZcuWmbalKCoqMiMjUmKU
lJQ4Ml421+51GI/4iUSEFE1SQJmvJp8jX18KycmTJ0uZpr0r0picNGmSfQUy
VKTU1dXJjcjyHABdMOLx0WtoaJAC374UGzZs0JekBFu/fr0dtIoOO4sC1GE8
4jMSicX1xQ0aNEiuRllZmfxXymedA/D3v//dLsblhmZiHr7Us1ojbNq0KfAP
z74zZ85IW8KxWbHeL3Nh5ek+efLkzZs3TayXhe53nYrw2GOPDfdNnmtpjUR2
JCtZMCKX/dNPP5VLrcWsydhauUgzUtotEhRL7W+/OmHChPQesfS4xCMBRiIp
VawZJQ3C2bNnywWXmxLf0pavWVpaKuGhFFB2ebVz585sJtIlHvEZicQiVmJI
KSEVaIddQzkRjEQna+lc/Tlz5vz888/ef0vaTpK1Jk6c2NramsYfJRgJli6y
S1izOGh/l2Stfv36xbe0jx07JlVMv3bm1eyv3XOJR3xGIuLAgQMPP/ywI4iW
53HKlCna0R1rb+WePn1amn9a32Uuo+qDkOVdrXTiQYeFpPaWyN2XUshEHKal
LZdoyZIlUhoXFhba8UiH02iD5RKP+I9E9HwBx0C//PuTTz4ZOnSojqDF2neG
aW5ubmpqkorYbrYFTqq2vOz2dmZOTU2NY29MvZUJTwLV03WTNS3k4sun6Qw6
ybHyKKXX2lHy648//rj/SERJUGPySdQkC0YkwVLc7dq1Sy6jZjmh7S7J/HKF
paFSX18v/96wYYN58BcuXJjlGXQJ45EAI5GY1Rsfbg+AfNNXXnll7ty5LS0t
9litDqlfuXKlpKRk6dKl0iDXlbz6atYmztkSxiP+I5FYoCWG/QkfffTRZ599
lmpizOe7Tw2KfjASnawl92LWrFny4VJmfv/9995/UTtX096VlGAkWBqnd7gK
QHLU1KlTpTEj/9CaSGnzRuogaWJJcSG54sSJE3369HHEyNmUMB7xH4nE2pdp
OPKtzsgaNmxYfOVlHkD3jCrXU2rANB5P/Xx7SDQLtLe/w1nQe/bsKS4ullaH
fDszPq5xk9T40vCTqFZiOrmSFRUVJi9lvwsxYTziPxKJ3R8ltPdvNDOy3nrr
rfgcaNpmLhch7erPfL6ZLZO7JFyVi2Bv7Kk5Sr5dwrNUdOdGedWxZObq1atS
jdqDvOo3v/nN6dOns/RlclayYETaJ9onYz/aUgtIYVVdXT1mzBhTTuqSN5Xl
TniTVDseCTYSid3vdE14lbLs559/1qferpqlnJHm4rhx40wjX1eW6atZHqsy
HPFIIJFIUCWGcePGjfXr1+uVTKPOMlGq++9GPxiJRSZrbd26VUvyVCMdiVK7
d+++ffv29P4uwUiwdAajl5to1iZIRK/5Svu65RelVWwa+bo+S9+Q5b5uwxGP
BBKJSLEgD5c9DCEtbZ39knCmok7Ud3n6mpubly1bpiPCaVRYGkWm97tSREjy
0lgtrk33DmdBt7WLWb1Aee3jKVKMV1ZWykXTC2KK/bwwBtGUIx4JJBIRX331
lWMr4L179+q8vkuXLsW/X1cAJWuY+az+YvejyOjXbqnS/nYpiJKdWmWqfvu7
y/XU4WC9I8OHD7cnEiTcDQa2Dhew27P0pRaQx0FalWagx8wbTKP9ECATgEja
Xn311QAjkZi/8jlDTC+iFLb19fULFy40A/qx+/N+9Q3ZH6syTAAid8R/JBIv
vRIj1p5bJBvPmDFDfvHhhx/WiruLByNGiFlLHlgpwM3ne9/zWTtM/JQ/BCPB
0uuZ0h0xk+GHDh0qtbY8MroETF/dtGmTqdZDnC5rApDly5f7j0Timd6VZAcY
mcrI8fRJC/zzzz8vKyuTMm3EiBH6EGUzGDl9+rQuG09jrzOdeuF9SaZJZF77
xl9yC0pLS69cuaKvms7DvFDXF5sA5Mknn5wzZ47/SCSeNMN0Vm2yEWF9phyP
YVDVX6zzBiOHDh3Sy5Is5DcDlHaPgfbASE1k794pz4VZ8pbTB9ZLfP1/fHNf
69dhMGJPzFi3bt1vf/tbefbNq7oPRuZ6Sr0z8YikJMBIJJZ6+SxXbOrUqf5n
90mJmuzemeHXsWPHyk2R0sDO/7rc3qVLJGs0Hslr7+0MNhKJpVtixNo74goK
Cl555ZVz586Zm5tGaWwi8UwEI5s3b/afhcRzzz2XUus6rKwlz68ErVVVVVJ3
6+cvXbrU4+/qCoW0TxGKBRGMZOGpT+bYsWP+q4k0/OMf/3C/nt6DEXv8/YUX
XliyZIk0tk0IbFbt5YXX121oPJLX3v8ZbCQSs0YGk43+6MClvOfTTz81P9SC
qFevXitXrpTcazJzGsFI2tMA7N0LU92MK9VgxIzeSnNaolSp7u1p8DpjU1MS
1iCaMvFIJiIRuVMSgrk8EeaZmjRpkl2GB1X9xe53EXSyYEQqEbNDbLLlMDpQ
27t3byl7zQ/lLjz22GPxQ1SNjY0Soecln6GREyQYGeubz2DEPNry+E+bNm3e
vHn2OKxuJu9+42zyBMmvfPbZZ5cvX5ZSQkKGoApzSdWqVauiEIzI+6UFGEiz
JGF7z66apQ1WXFxsl0X2SJaXdYhy3aTy2rNnT0NDg9QgcoMCLDNPnjw5vH3n
k8CDkbRLjFh7BG1arZENRuSxlQzgPxdJ0857Ez3ErCUP15QpU+R2mFaN94tm
uqTS3o/UfzCS6afehWRv/9VEGgIMRsyC97z2tQNSp9sFuL3f1FgPmyNJ0+vg
wYOS8SSLSpaWuibAkya++OILzSqBByPylYcNG6ZfM1mtrRNv4qflSIPHPCyd
PhjRBe/aupNs41guYe831WFcr1OIJatIhvmxXYADo/Jp0l7KRDAi31e+tfsT
YWb0Ofrigqr+Yp00GJEw37RpkxXF2innGOnYt29fwtkCZu/uEOcO5YQOgxEz
Pi43aODAgY6L6X3BiNQI0i6yl/ZIQzGojgsTiZSUlHT6aVr2MLRcQ6kF7Gvo
fVa/lMMff/yx2dtfb7GEnEF1PGokUlBQsHjx4sCnaaVdYjj4KY073zStsLJW
S0vLpEmTpD0Qs+Y5S8NMCg0vydbGyZYtW1L8uv+FaVrBSjUY0XDSZDzHA+V9
wYjkyddee83eTKlbt25lZWVBtQM1EunVq5dUfIFP05JGo6Y5WV+36Stw3/ja
TzCSdmWnBzLmZWWalgl85OZKRd/c3Gxe8r5gRO5aXV2dme6lZZR8YFADviYS
mTp1auDTtCQUNfNVkj0R2o2cbDmJ8hmMdL5pWnb+SbaNg/acyLPv2NVTspO9
oNWWcL4cHNyDEbunNC9uaqLdneXeUyoxozwUUpJL1CD59sCBAxqzB7JdvJmg
pRNHO/ECdmUPQ8dPLTa9RnmuY1V6QHlFRYV8O2k6Xrx4UZruXo7w80gnaEmr
oLq6WvJMIAvYDT8lhgPBiC2srCW/ItGldl+bNMi9a2ho8JJsSUzv3r2PHj2a
ynf9DwQjwfK+gF3ZWaukpMRxyIU9OdClytA17/KGO+0kP0yfPt09r6ZEJ2hJ
JKK75wWygN0w/dh5/3nMik0nRXd4mE4owYj66aef0rgUHhewK7vVEd8FYc8b
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
    "], {{0, 162}, {1071, 0}}, {0, 255},
    ColorFunction->RGBColor],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->{576.3846153846166, Automatic},
  ImageSizeRaw->{1071, 162},
  PlotRange->{{0, 1071}, {0, 162}}]], "Input",
 CellChangeTimes->{{3.7707349256083384`*^9, 
  3.7707349352881374`*^9}},ExpressionUUID->"f8c0f08a-ad3a-48a3-8ffd-\
927f0b460a0f"],

Cell["\<\
So to get the unity vector with the direction of the refraction we use the \
Snell law and feet it with the following vector, where the first one is the \
ray form the object to the surface and the second one is the normal vector of \
the surface.\
\>", "Text",
 CellChangeTimes->{{3.7707349455101194`*^9, 
  3.7707350136105547`*^9}},ExpressionUUID->"5656cda2-4efa-45a1-afaa-\
c9a839dbfa6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"v1", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["ra", 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "ra", ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"za", "[", 
            RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "-", "ta"}], ")"}], 
         "2"]}]]], ",", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"za", "[", 
         RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "-", "ta"}], ")"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", "ra", ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"za", "[", 
            RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "-", "ta"}], ")"}], 
         "2"]}]]], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"na", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"dza", "[", 
       RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"dza", "[", 
           RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "2"], "+", 
        "1"}]]], ",", 
     FractionBox[
      RowBox[{"-", "1"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"dza", "[", 
           RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "2"], "+", 
        SuperscriptBox["1", "2"]}]]], ",", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7707349223544025`*^9, 3.7707349227415285`*^9}, {
  3.7707350266174836`*^9, 3.770735145425256*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"df3ce495-446e-4af2-a5b0-e72020baeb63"],

Cell["\<\
Where, dza is the derivative of a with respect to  za. So with the Snell\
\[CloseCurlyQuote]s law we have, dza will be very useful since in the vector \
na, which us the normalvector of za, dza appears, so the next step is to use \
the Snell law in its vector form as it shown in the picture, please notice \
that here we use the Cross function as well as the FullSimplify.\
\>", "Text",
 CellChangeTimes->{{3.7707364800779886`*^9, 3.77073649059091*^9}, {
  3.7707367900390973`*^9, 3.7707368031180124`*^9}, {3.770770311496853*^9, 
  3.77077040676921*^9}},ExpressionUUID->"eddde2ad-b243-45fd-81b0-\
e53228602491"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "/", "n"}], ")"}], 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"na", ",", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"-", "na"}], ",", "v1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
  "-", 
  RowBox[{"na", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"n", "^", "2"}]}], ")"}], 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"na", ",", "v1"}], "]"}], "]"}], ".", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"na", ",", "v1"}], "]"}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"63cd8079-6fcf-4c15-90d6-62acb1ba1b2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ra", "+", 
      RowBox[{
       RowBox[{"dza", "[", 
        RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "ta"}], "+", 
         RowBox[{"za", "[", 
          RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}]}]}], 
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"dza", "[", 
          RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["ra", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ta", "-", 
           RowBox[{"za", "[", 
            RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}]]}]], 
    "-", 
    FractionBox[
     RowBox[{
      RowBox[{"dza", "[", 
       RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"ra", "+", 
            RowBox[{
             RowBox[{"dza", "[", 
              RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "ta"}], "+", 
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}]}]}], 
           ")"}], "2"], 
         RowBox[{
          SuperscriptBox["n", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"dza", "[", 
              RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["ra", "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"ta", "-", 
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}], 
           ")"}]}]]}]]}], 
     SqrtBox[
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"dza", "[", 
         RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "2"]}]]]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"dza", "[", 
       RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"ra", "+", 
        RowBox[{
         RowBox[{"dza", "[", 
          RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "ta"}], "+", 
           RowBox[{"za", "[", 
            RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}]}]}], ")"}]}], 
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox[
         RowBox[{"dza", "[", 
          RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["ra", "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ta", "-", 
           RowBox[{"za", "[", 
            RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}]]}]], 
    "+", 
    FractionBox[
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ra", "+", 
           RowBox[{
            RowBox[{"dza", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", 
              RowBox[{"za", "[", 
               RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}]}]}], ")"}],
          "2"], 
        RowBox[{
         SuperscriptBox["n", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"dza", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["ra", "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"za", "[", 
               RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}], 
          ")"}]}]]}]], 
     SqrtBox[
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"dza", "[", 
         RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "2"]}]]]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.770735229140517*^9, 3.7707667621690845`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"65d4f72c-9b40-417f-9186-3aa1834f6d49"]
}, Open  ]],

Cell["\<\
Where the components of the solution we are going to called as ra1 and za1. \
Also notice that the last element of the list is 0, this happens because we \
are working in a two dimensional case, so we can just ignore the last \
element, we use this trick in order to use the function Cross which is for \
vectors/list in three dimensions.  Therefore, for plotting proposes we have,\
\>", "Text",
 CellChangeTimes->{{3.7707352842856827`*^9, 3.77073533733127*^9}, {
   3.770735437817669*^9, 3.77073546081945*^9}, {3.7707368930015306`*^9, 
   3.7707369115795937`*^9}, {3.7707704128279986`*^9, 3.770770506881544*^9}, 
   3.770770562092067*^9},ExpressionUUID->"b4c90546-1b24-47e0-8561-\
6879b5d64b56"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"za", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "ta"}], "+", 
     SqrtBox[
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["n", "2"]}], ")"}], " ", 
        SuperscriptBox["ra", "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
        SuperscriptBox["ta", "2"]}]}]]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["n", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dza", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"a", "=", 
      FractionBox["ra", 
       SqrtBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["n", "2"]}], ")"}], " ", 
          SuperscriptBox["ra", "2"]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], "2"], " ", 
          SuperscriptBox["ta", "2"]}]}]]]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ra1", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{"t", "=", 
      RowBox[{
       FractionBox[
        RowBox[{"ra", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "ta"}], "+", 
            RowBox[{"za", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], " ", 
          RowBox[{"dza", "[", 
           RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}]}], 
        RowBox[{"n", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["ra", "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"za", "[", 
               RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}]], 
         " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"dza", "[", 
              RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "2"]}], 
          ")"}]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"dza", "[", 
          RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"ra", "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "ta"}], "+", 
                  RowBox[{"za", "[", 
                   RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], " ", 
                RowBox[{"dza", "[", 
                 RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}]}], ")"}], "2"], 
            RowBox[{
             SuperscriptBox["n", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["ra", "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"ta", "-", 
                  RowBox[{"za", "[", 
                   RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], 
                "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"dza", "[", 
                  RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "2"]}], 
              ")"}]}]]}]]}], 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dza", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], 
           "2"]}]]]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"za1", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{"t", "=", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"dza", "[", 
          RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"ra", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "ta"}], "+", 
              RowBox[{"za", "[", 
               RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], " ", 
            RowBox[{"dza", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}]}], ")"}]}], 
        RowBox[{"n", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["ra", "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ta", "-", 
              RowBox[{"za", "[", 
               RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}]], 
         " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"dza", "[", 
              RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "2"]}], 
          ")"}]}]], "+", 
       FractionBox[
        SqrtBox[
         RowBox[{"1", "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"ra", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "ta"}], "+", 
                 RowBox[{"za", "[", 
                  RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], " ", 
               RowBox[{"dza", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}]}], ")"}], "2"], 
           RowBox[{
            SuperscriptBox["n", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["ra", "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"ta", "-", 
                 RowBox[{"za", "[", 
                  RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ")"}], "2"]}],
              ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"dza", "[", 
                 RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "2"]}], 
             ")"}]}]]}]], 
        SqrtBox[
         RowBox[{"1", "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"dza", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], 
           "2"]}]]]}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.729292388522123*^9, 3.7292924571158333`*^9, {3.7292925041906013`*^9, 
   3.7292925286643248`*^9}, {3.7292926929104996`*^9, 3.729292731185524*^9}, {
   3.7292928361734605`*^9, 3.7292928389908543`*^9}, 3.729293064853711*^9, 
   3.7292931009719796`*^9, {3.738354943118023*^9, 3.738355006435937*^9}, {
   3.770420386634367*^9, 3.770420401486351*^9}, {3.7704204542780495`*^9, 
   3.770420454838578*^9}, {3.7704206038206887`*^9, 3.770420604154785*^9}, {
   3.7704207365440683`*^9, 3.770420772757203*^9}, {3.770421869105109*^9, 
   3.7704218856171417`*^9}, 3.7704227569838233`*^9, {3.7704228045142975`*^9, 
   3.770422851598674*^9}, {3.7704228841081533`*^9, 3.7704228898307505`*^9}, {
   3.770422934311347*^9, 3.7704229462560525`*^9}, {3.7704232974317436`*^9, 
   3.7704232977339625`*^9}, {3.770423532180551*^9, 3.770423605431576*^9}, {
   3.77050419630595*^9, 3.770504276801911*^9}, {3.770504773144596*^9, 
   3.770504773609809*^9}, {3.770725361675026*^9, 3.770725391172117*^9}, 
   3.770725509813429*^9, {3.770725568125472*^9, 3.770725597419074*^9}, 
   3.770726154229409*^9, 3.770726219772073*^9, 3.770726535150662*^9, 
   3.7707349154937544`*^9, {3.770735174765806*^9, 3.7707352254415517`*^9}, {
   3.770735257751354*^9, 3.7707352629135714`*^9}, {3.7707512303041115`*^9, 
   3.7707512305185723`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d18376a2-e1a6-4019-8d2e-a4d1141efc96"],

Cell["\<\
Now we defined the Range in which we are going to plot the Cartesian Oval, \
the range comes form -rmax to rmax and the variable in that range is ra, \
which is the independent variables insde za, zda, za1 and ra1. The other \
variables n,ta are, in fact, constants: the refraction index and the focus \
respectively.\
\>", "Text",
 CellChangeTimes->{{3.770505037091671*^9, 3.770505065349392*^9}, {
   3.770725069256111*^9, 3.770725091756915*^9}, 3.7707265820292616`*^9, {
   3.770770568152717*^9, 
   3.7707706539307795`*^9}},ExpressionUUID->"39423560-7320-47aa-8aa9-\
f788acd08b1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rmax", "=", "15"}], ";"}]], "Input",
 CellChangeTimes->{{3.770727040515854*^9, 3.77072704311889*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"a80ca940-0434-43f4-bc5c-84cf831063b0"],

Cell["\<\
In this section is the ray tracing of the code, we plot the normal, \
tangential vector and the cosine directors, and uu is the plot of the unity \
vector by its components ra1 and za1. But first lets start with the rays that \
are given our function l[ra,n,ta]. uu[ra,n,ta] other other hand is the unity \
vector with the direction of the refracted rays.\
\>", "Text",
 CellChangeTimes->{{3.770505095463214*^9, 3.770505095719926*^9}, {
  3.770505201325015*^9, 3.770505245415737*^9}, {3.7707354996226883`*^9, 
  3.7707355259538937`*^9}, {3.7707706691569796`*^9, 
  3.77077073651367*^9}},ExpressionUUID->"524ef5d6-7df6-4962-93bd-\
d236bdf1f457"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"l", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{"t", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "ta"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ra", ",", 
            RowBox[{"za", "[", 
             RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ra", ",", "20"}], "}"}]}], "}"}], "]"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"uu", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{"t", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Red", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ra", ",", 
              RowBox[{"za", "[", 
               RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ra", "+", 
               RowBox[{"ra1", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "+", 
               RowBox[{"za1", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}]}]}], "}"}]}], 
           "}"}], "]"}]}], "}"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.770422166735112*^9, 3.770422219344904*^9}, {
   3.770422549039988*^9, 3.770422595136036*^9}, {3.7704226912572327`*^9, 
   3.77042270142692*^9}, {3.7704228635355425`*^9, 3.77042287067323*^9}, {
   3.7704229521305385`*^9, 3.7704229837434187`*^9}, {3.770423101338344*^9, 
   3.7704231671221886`*^9}, {3.770423455676633*^9, 3.770423462581374*^9}, {
   3.7705045453802533`*^9, 3.7705046233046875`*^9}, 3.7707248138233857`*^9, {
   3.770724904803996*^9, 3.770724905265761*^9}, {3.7707250088182917`*^9, 
   3.770725012917324*^9}, 3.770725138826*^9, {3.770725178356255*^9, 
   3.770725178707316*^9}, 3.7707288624425335`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"9314ce18-4e29-4fc5-8770-51460b21cc6d"],

Cell["\<\
We also want to plot the normal vector and tangential vector of the surface \
of the Cartesian oval, therefore we defined the following unity vectors: the \
function called nor[ra,n,ta] is the normal vector of the Cartesian Oval and \
the function called tan[ra,n,ta] tangential line at point ra in za.\
\>", "Text",
 CellChangeTimes->{{3.7707288778810945`*^9, 3.7707289094266105`*^9}, {
  3.770728954529637*^9, 3.7707289891397514`*^9}, {3.770770757195911*^9, 
  3.7707708049061165`*^9}},ExpressionUUID->"6731e563-fc77-444b-a199-\
48ab0585ba70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nor", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t1", "}"}], ",", 
     RowBox[{"t1", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Dashed", ",", "Green", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ra", "+", 
               RowBox[{
                RowBox[{"dza", "[", 
                 RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "-", 
               RowBox[{"1", "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ra", "-", 
               RowBox[{
                RowBox[{"dza", "[", 
                 RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "+", 
               RowBox[{"1", "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
        "}"}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tan", "[", 
    RowBox[{"ra_", ",", "n_", ",", "ta_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t1", "}"}], ",", 
     RowBox[{"t1", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Dashed", ",", "Blue", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ra", "-", 
               RowBox[{"1", "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "-", 
               RowBox[{
                RowBox[{"dza", "[", 
                 RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ra", "+", 
               RowBox[{"1", "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"za", "[", 
                RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "+", 
               RowBox[{
                RowBox[{"dza", "[", 
                 RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "/", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"dza", "[", 
                    RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], ")"}], "^", 
                   "2"}], "+", "1"}], "]"}]}]}]}], "}"}]}], "}"}], "]"}]}], 
        "}"}], "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"a93ac28b-6726-4d11-96a4-0832bcebf235"],

Cell["\<\
Here in this section is the manipulation of the Cartesian oval collimator, in \
this manipulation we express how must be the  Cartesian oval collimator for a \
given n, ta. The user can play with the manipulate and see how the shape of \
za change respect with n, ta. Also with this manipulate the user can change \
the number of rays as well as the distances between the rays. Finally the \
normal vector as well the tangential vector are plotted for every ray.\
\>", "Text",
 CellChangeTimes->{{3.770505267054826*^9, 3.770505283812923*^9}, {
  3.770770807766612*^9, 
  3.7707709562794824`*^9}},ExpressionUUID->"425d8d5d-536b-4d12-b8d8-\
c3ff3dc21170"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"za", "[", 
         RowBox[{"ra", ",", "n", ",", "ta"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ra", ",", 
         RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Black", "}"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"r", ",", "z"}], "}"}]}], ",", 
       RowBox[{"Filling", "\[Rule]", "20"}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Red=cosine directors, Blue/Green=tangencial/normal \
vectors\>\""}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l", "[", 
          RowBox[{"i", ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"l", "[", 
          RowBox[{
           RowBox[{"-", "i"}], ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"uu", "[", 
          RowBox[{"i", ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"nor", "[", 
          RowBox[{"i", ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"tan", "[", 
          RowBox[{"i", ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"uu", "[", 
          RowBox[{
           RowBox[{"-", "i"}], ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"nor", "[", 
          RowBox[{
           RowBox[{"-", "i"}], ",", "n", ",", "ta"}], "]"}], ",", 
         RowBox[{"tan", "[", 
          RowBox[{
           RowBox[{"-", "i"}], ",", "n", ",", "ta"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "gg"}], ",", "g", ",", "gg"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "25"}], ",", "25"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "60"}], ",", "20"}], "}"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "1.5", ",", "\"\<Refraction index: n\>\""}], "}"}], 
     ",", "1.5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ta", ",", 
       RowBox[{"-", "50"}], ",", "\"\<Focus: ta\>\""}], "}"}], ",", 
     RowBox[{"-", "50"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"g", ",", "8", ",", "\"\<Lines\>\""}], "}"}], ",", 
     RowBox[{"-", "15"}], ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gg", ",", "2", ",", "\"\<Space between lines\>\""}], "}"}], 
     ",", "2", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7707357574551167`*^9, {3.7707358144914536`*^9, 3.7707358287425327`*^9}, {
   3.770735893499585*^9, 3.7707360885372105`*^9}, {3.7707361273907776`*^9, 
   3.770736165988098*^9}, {3.770736203629505*^9, 3.770736222161962*^9}, {
   3.7707362673638134`*^9, 3.770736269763819*^9}, {3.7707363071400757`*^9, 
   3.770736311292677*^9}, 3.770736347871194*^9, {3.7707510323984923`*^9, 
   3.770751168513274*^9}, {3.7707513114542513`*^9, 3.7707513154199486`*^9}, {
   3.770770938900798*^9, 3.7707709420108643`*^9}, {3.770771001066741*^9, 
   3.770771003172681*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"d80d34da-a71e-4c70-b330-d2c4e3983f60"]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
DockedCells->{
  Cell[
   TextData[{
     StyleBox["  WOLFRAM ", 
      RGBColor[0.97, 0.83, 0.35], FontFamily -> "Source Sans Pro", FontWeight -> 
      Bold, FontSize -> 40], 
     StyleBox["SUMMER SCHOOL", 
      GrayLevel[1], FontFamily -> "Source Sans Pro", FontSize -> 40], 
     StyleBox[" 2019", 
      RGBColor[0.97, 0.83, 0.35], FontFamily -> "Source Sans Pro", FontSize -> 
      40]}], CellFrameMargins -> 10, Background -> 
   RGBColor[0.12, 0.14, 0.15]]},
Magnification->1.5,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 3, 80, "Subsection",ExpressionUUID->"0a0c05ef-d25e-483c-a9d6-8227b43c03fe"],
Cell[CellGroupData[{
Cell[782, 27, 226, 4, 105, "Title",ExpressionUUID->"3c68f453-d93c-4770-a810-86b2cbc3059d"],
Cell[1011, 33, 774, 14, 119, "Text",ExpressionUUID->"d824b6da-0fc2-489b-b28b-babdff7e86c5"],
Cell[CellGroupData[{
Cell[1810, 51, 659, 20, 43, "Input",ExpressionUUID->"89fc2d61-13f5-499c-84d7-ae02fb259491"],
Cell[2472, 73, 621, 21, 63, "Output",ExpressionUUID->"5647ec4e-d22a-4c6e-805b-70e666f690d7"]
}, Open  ]],
Cell[3108, 97, 772, 13, 119, "Text",ExpressionUUID->"396a3057-5a76-49cb-8f73-008848b08113"],
Cell[CellGroupData[{
Cell[3905, 114, 930, 25, 43, "Input",ExpressionUUID->"db1aa806-1d9c-4296-8230-b009757f0115"],
Cell[4838, 141, 458, 12, 63, "Output",ExpressionUUID->"e3d727d2-780b-4267-a921-777cabdc2220"]
}, Open  ]],
Cell[5311, 156, 407, 8, 52, "Text",ExpressionUUID->"23360abf-7ed9-45db-a940-d275fb0dd6d9"],
Cell[CellGroupData[{
Cell[5743, 168, 658, 17, 67, "Input",ExpressionUUID->"76a6dc3b-8e8a-4d2c-a86d-3b8f2dce7ff7"],
Cell[6404, 187, 1714, 55, 86, "Output",ExpressionUUID->"4050e38b-5c2b-424f-beac-d6d0453ce312"]
}, Open  ]],
Cell[8133, 245, 518, 9, 86, "Text",ExpressionUUID->"6fa46ee5-f075-4a08-a0c5-feacafba4ffe"],
Cell[8654, 256, 534, 14, 43, "Input",ExpressionUUID->"b97b2dc8-58c8-4114-a561-56cd11a40d4c"],
Cell[9191, 272, 534, 14, 43, "Input",ExpressionUUID->"497c2507-61a5-47f6-8380-af0162628751"],
Cell[CellGroupData[{
Cell[9750, 290, 697, 15, 43, "Input",ExpressionUUID->"c8c9f424-4879-4255-8a9a-9987c645a812"],
Cell[10450, 307, 22905, 434, 365, "Output",ExpressionUUID->"91358c7e-be56-42c5-9789-5102894f736a"]
}, Open  ]],
Cell[33370, 744, 350, 7, 52, "Text",ExpressionUUID->"f97fcd83-c9d2-462b-958d-d0935e1c04c9"],
Cell[33723, 753, 345, 7, 52, "Text",ExpressionUUID->"10670887-f09d-4043-8369-1253eb0bef9c"],
Cell[34071, 762, 248, 6, 52, "Text",ExpressionUUID->"0ec191c2-c945-4bfd-aab1-c144622a8e0d"],
Cell[34322, 770, 16607, 277, 151, "Input",ExpressionUUID->"f8c0f08a-ad3a-48a3-8ffd-927f0b460a0f"],
Cell[50932, 1049, 401, 8, 86, "Text",ExpressionUUID->"5656cda2-4efa-45a1-afaa-c9a839dbfa6a"],
Cell[51336, 1059, 1773, 56, 177, "Input",ExpressionUUID->"df3ce495-446e-4af2-a5b0-e72020baeb63"],
Cell[53112, 1117, 622, 10, 86, "Text",ExpressionUUID->"eddde2ad-b243-45fd-81b0-e53228602491"],
Cell[CellGroupData[{
Cell[53759, 1131, 875, 27, 43, "Input",ExpressionUUID->"63cd8079-6fcf-4c15-90d6-62acb1ba1b2d"],
Cell[54637, 1160, 4483, 138, 260, "Output",ExpressionUUID->"65d4f72c-9b40-417f-9186-3aa1834f6d49"]
}, Open  ]],
Cell[59135, 1301, 706, 11, 119, "Text",ExpressionUUID->"b4c90546-1b24-47e0-8561-6879b5d64b56"],
Cell[59844, 1314, 8286, 230, 450, "Input",ExpressionUUID->"d18376a2-e1a6-4019-8d2e-a4d1141efc96"],
Cell[68133, 1546, 594, 11, 86, "Text",ExpressionUUID->"39423560-7320-47aa-8aa9-f788acd08b1f"],
Cell[68730, 1559, 214, 4, 43, "Input",ExpressionUUID->"a80ca940-0434-43f4-bc5c-84cf831063b0"],
Cell[68947, 1565, 654, 11, 86, "Text",ExpressionUUID->"524ef5d6-7df6-4962-93bd-d236bdf1f457"],
Cell[69604, 1578, 2470, 61, 102, "Input",ExpressionUUID->"9314ce18-4e29-4fc5-8770-51460b21cc6d"],
Cell[72077, 1641, 555, 9, 86, "Text",ExpressionUUID->"6731e563-fc77-444b-a199-48ab0585ba70"],
Cell[72635, 1652, 4906, 127, 305, "Input",ExpressionUUID->"a93ac28b-6726-4d11-96a4-0832bcebf235"],
Cell[77544, 1781, 663, 11, 119, "Text",ExpressionUUID->"425d8d5d-536b-4d12-b8d8-c3ff3dc21170"],
Cell[78210, 1794, 3511, 91, 160, "Input",ExpressionUUID->"d80d34da-a71e-4c70-b330-d2c4e3983f60"]
}, Open  ]]
}
]
*)

